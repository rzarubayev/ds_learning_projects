# Проект. Улучшение baseline-модели

## Описание задачи
Выступить надёжным посредником между арендодателями или продавцами и потенциальными арендаторами или покупателями, сделав процесс сделки максимально эффективным и безопасным для обеих сторон.

## Проблема
Разработано базовое решение в виде модели машинного обучения, а также организован пайплайн данных в Airflow. Менеджеры убедились, что модель потенциально прибыльна, однако вместе с тем сделали вывод, что метрики модели можно улучшить. 

## Бизнес-задача
Нужно оптимизировать подход, основываясь на первоначально построенном решении и настроенном пайплайне данных. Необходимо сделать процесс воспроизводимым и улучшить ключевые модельные метрики, которые влияют на бизнес-показатели компании, в частности, на увеличение количества успешных сделок. Чтобы провести большое число экспериментов и обеспечить их воспроизводимость, необходимо интегрировать MLflow.

## Задача машинного обучения
Процесс прогнозирования стоимости требует доработки. Используя методы конструирования и отбора признаков, а также примененяя алгоритмы для поиска оптимальных гиперпараметров модели, нужно улучшить основную метрику проекта, которая влияет на точность предсказаний стоимости недвижимости и, как следствие, на количество успешных сделок на маркетплейсе. В процессе работы все эксперименты должны быть документированы в MLflow, — это позволит вам отслеживать изменения в метриках и вносимые улучшения. Все успешные версии моделей должны быть зарегистрированы в соответствующем реестре MLflow для возможности их отслеживать, сравнивать и использовать впоследствии. Таким образом систематизируется процесс разработки и оценки моделей, а также будет обеспечена воспроизводимость результатов. 

---
# Jupyter блокнот проекта

Основной блокнот jupyter - файл '[model_improvement/model_improvement.ipynb](model_improvement/model_improvement.ipynb)' (В GitHub могут быть проблемы с рендером и возможно потребуется несколько раз обновить страницу, также можно скачать на локальный компьютер и использовать VSCode/PyCharm/Jupyter для просмотра).

> При запуске кода лучше использовать отдельное виртуальное окружение для данного проекта с Python 3.12 как в виртуальной машине Яндекс Практикум. В качестве примера далее используется директория `.venv` (если окружение установлено в другую директорию, необходимо использовать его в качестве ядра для блокнота jyputer и активировать в командной строке). Установка зависимостей включена в основной блокнот jupyter.

---
# Запуск MLflow

1. Для запуска MLflow необходимо в командной строке активировать виртуальное окружение python (если не активировано):

```sh
source .venv/bin/activate
```

2. Запуск сервера MLflow производится путем запуска скрипта `run-mlflow.sh` в папке `mlflow_server`

```sh
./mlflow_server/run-mlflow.sh
```

В папке `mlflow_server` также располагается блокнот jupyter с EDA (подготовлен на базе основного блокнота, но без ячеек с выводом для снижения размера), трансформер для обработки выбросов и файл параметров для трансформера, а также Markdown файл с выводами. Все графики и блокнот c EDA jupyter логированы в MLflow.
